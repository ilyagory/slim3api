## Допущения

В запросе на создание контактов, количество записей в `items` достаточно мало, чтобы обрабатываться одним синхронным
запросом. Если загружать намного бОльшие кол-ва контактов, имеет смысл задуматься об асинхронном запросе с отображением
прогресса загрузки или придумать какие-то очереди.

## Авторизация

Каждый запрос должен содержать валидный API Key (хранится в конфиге) в заголовке `X-Apikey`. Иначе, сервер ответит
отказом со статусом 403.

## Жизненный цикл создания котактов

(POST /contacts)

1. Запрос проходит через `Middleware\Validator`, где валидируется по схеме `/schema/contact.create.json`
   отсутствует `source_id` или он не число, если отстутсвует `items` или он не массив или он пуст, запрос на ответ -
   статус 400
1. Контроллер вызывает `Repository\Contacts`
1. Если у контакта отсутствуют или невалидны:
    - телефон (число как минимум 10 знаков),
    - имя (строка, как минимум 3 символа),
    - email (строка, email),

то этот контакт не обрабатывается.

4. Если в БД уже присутсвуют контакты того же источника (`source_id`), созданные менее 24 часов назад, этот контакт не
   обрабатывается. Все остальные контакты сохраняются, а сервер отвечает на запрос статусом 200 и json содержимым с
   количеством созданных контактов `{"created":0}` (0 если не создано ни одного)

## Каталоги

- `/www` - публичный
- `/app` - приложене
- `/schema` - файлы JSON-Schema для валидации входящих данных при создании контактов

## Конфигурация

`/app/config.exmaple.ini` - конфиг нужно заполнить и переименовать в `/app/config.ini`

## Приложение

- `Controller/Contacts` - контроллер "контакты", содержит 2 метода (дейтсвия):
    - сохранить контакты - возвращает `{"created":N}`, где N - число сохранённых контактов,
    - поиск контактов по телефону

- `Model/Contact` - модель Контакта, в ней указаны поля модели, способ кодирования в json..

- `Repository/Contacts` - класс, содержит методы сохранения и выборки из БД, имеющие отношение к Контактам

- `Middleware/Auth` - промежуточный обработчик, отвечает за аутентификацию. Если запрос не несёт верного ключа в заголовке, то сервер вернёт статус 403.

- `Middleware/Validator` - промежуточный обработчик для валидации входящего json при создании контактов. если json не
  валиден по схеме `schema/contact.create.json`, запрос вернёт ошибку 400

## Примеры

1. Создать

```shell
curl -vv -X POST -H 'Content-Type:application/json' -H 'X-Apikey:testapi' -d
@testdata1.json http://localhost:3000/contacts
```

1. Искать

```shell
 curl -vv -H 'Content-Type:application/json' -H 'X-Apikey:testapi' 'http://localhost:3000/contacts?phone=9001234453'
```
